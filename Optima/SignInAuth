// Joaquin Justiniano 

// Content View File: 

import SwiftUI
import FirebaseCore
import FirebaseAuth



struct ContentView: View {
    @State private var email: String = ""
    @State private var password: String = ""
    @State private var showingAlert: Bool = false
    @State private var isLoggedIn: Bool = false
    @State private var isLoading: Bool = false
    @State private var errorMessage: String = ""
       
       var body: some View {
           VStack {
               Text("Sign In")
                   .font(.largeTitle)
                   .fontWeight(.bold)
                   .padding(.bottom, 20)
                   
               
               TextField("Email", text: $email)
                   .padding()
                   .background(Color(.systemGray6))
                   .cornerRadius(10)
                   .padding(.horizontal)
                   .autocapitalization(.none)
               
               SecureField("Password", text: $password)
                   .padding()
                   .background(Color(.systemGray6))
                   .cornerRadius(10)
                   .padding(.horizontal)
                   .padding(.top, 10)
               
               Button(action: {
                   login()
                   
               }) {
                   Text("Sign In")
                       .frame(maxWidth: .infinity)
                       .padding()
                       .background(Color.blue)
                       .foregroundColor(.white)
                       .cornerRadius(10)
                       .padding(.horizontal)
                       .padding(.top, 20)
               }
               .alert(isPresented: $showingAlert) {
                   Alert(title: Text("Error"), message: Text("Email and password cannot be empty."), dismissButton: .default(Text("OK")))
               }
               
               Spacer()
               
               
               
               if isLoggedIn{
                   Text("Logged in successfully!")
               }
               
           }
           .padding()
       }
    func login() {
        isLoading = true
        errorMessage = ""
        Auth.auth().signIn(withEmail: email, password: password) {authResult, error in
            isLoading = false
            if let error = error {
                errorMessage = error.localizedDescription
                isLoggedIn = false
            } else { // Login successful
                isLoggedIn = true
                errorMessage = "" // You can save the user session here if needed
                if let user=authResult?.user { // Access user information
                    let uid = user.uid
                    let email = user.email
                    print("Logged in user: \(uid), email: \(email ?? "no email")")
                }
            }
        }
        
    }
    
     
   }


#Preview {
    ContentView()
}





// Sign in page App file:

import SwiftUI
import FirebaseCore
import FirebaseAuth



class AppDelegate: NSObject, UIApplicationDelegate {
  func application(_ application: UIApplication,
                   didFinishLaunchingWithOptions launchOptions: [UIApplication.LaunchOptionsKey : Any]? = nil) -> Bool {
    FirebaseApp.configure()

    return true
  }
}

@main
struct Sign_in_pageApp: App {
    // register app delegate for Firebase setup
    @UIApplicationDelegateAdaptor(AppDelegate.self) var delegate
    var body: some Scene {
        WindowGroup {
            ContentView()
        }
    }
}
